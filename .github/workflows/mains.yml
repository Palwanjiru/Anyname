name: Get libflutter.so

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  download:
    runs-on: ubuntu-latest
    
    steps:
      - name: Download Flutter 3.35.2 Engine libs
        run: |
          mkdir -p libflutter_so
          cd libflutter_so
          
          # Flutter 3.35.2 specific engine artifacts
          FLUTTER_VERSION="3.35.2"
          ENGINE_VERSION="9d1a6dced7c2d6f2d8e2c56e9c1b8d4b4a0e1a0a"  # This is the engine version for 3.35.2
          
          # Download ARM64
          curl -L -o arm64.zip "https://storage.googleapis.com/flutter_infra_release/flutter/$ENGINE_VERSION/android-arm64-release/linux-x64.zip"
          unzip -j arm64.zip "flutter/bin/cache/artifacts/engine/android-arm64-release/libflutter.so" -d ./
          mv libflutter.so libflutter_arm64.so
          
          # Download ARM
          curl -L -o arm.zip "https://storage.googleapis.com/flutter_infra_release/flutter/$ENGINE_VERSION/android-arm-release/linux-x64.zip"
          unzip -j arm.zip "flutter/bin/cache/artifacts/engine/android-arm-release/libflutter.so" -d ./
          mv libflutter.so libflutter_arm.so
          
          ls -la

      - name: Upload libflutter.so
        uses: actions/upload-artifact@v4
        with:
          name: libflutter-so-3.35.2
          path: libflutter_so/*.so
